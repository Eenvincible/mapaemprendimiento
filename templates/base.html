<!DOCTYPE html>
<html>
<head>
    <title>Mapa Emprendimiento Ecuador - EcuadorStartups</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link rel="Shortcut Icon" type="image/png" href="/static/img/favicon.png" />
    <link href="/static/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="/static/css/styles.css" rel="stylesheet" media="screen">

    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true"></script>
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/markers.js"></script>
    <script>

        $(function() {
            var mapOptions = {
                zoom: 13,
                center: new google.maps.LatLng(-2.200158,-79.900503),
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map($('#map_canvas').get(0), mapOptions);

            google.maps.event.addListener(map, 'maptypeid_changed', function() {

                var t = map.mapTypeId;
                if (t==google.maps.MapTypeId.SATELLITE || t==google.maps.MapTypeId.HYBRID) {
                    // WHITE THEME
                    $("#logo").attr("src","/static/img/logomee-white.png");
                    $(".lnktype").addClass("whitetheme");
                } else {
                    // NORMAL THEME
                    $("#logo").attr("src","/static/img/logomee.png");
                    $(".lnktype").removeClass("whitetheme");
                }

            });

            google.maps.event.addListener(map, 'click', function(e) {
                alert("POS: "+ e.latLng.lat()+" , "+ e.latLng.lng());
            });

            types = {
                {% for t in types %}"{{ t.id }}": {"name": "{{ t.name }}", "image": "{{ t.image }}"} {% if not forloop.last %},{% endif %}{% endfor %}
            };

            companies = [
                {% for c in companies %}{"id": "{{ c.id }}", "name": "{{ c.companyname }}", "type": "{{ c.type.id }}", "lat": {{ c.lat|stringformat:"f" }}, "lng": {{ c.lng|stringformat:"f" }} } {% if not forloop.last %},{% endif %}
                {% endfor %}
            ];


            showMarkers = function() {
                for (var i in companies) {
                    var company = companies[i];
                    var marker = new google.maps.Marker({
                        draggable: false,
                        raiseOnDrag: false,
                        icon: image1,
                        shadow: shadow,
                        shape: shape,
                        map: map,
                        title: company.name,
                        position: new google.maps.LatLng(company.lat, company.lng)
                    });
                }
            };
            showMarkers();



        });


    </script>
</head>
<body>
<div class="canvas">

    <div id="lateral">

        <div class="row-fluid" style="margin-bottom: 20px;">
            <span class="span12">
                {% for type in types %}
                <a href="#" class='lnktype'><img src="/static/img/{{ type.image }}" alt="{{ type.name }}"/> {{ type.name }} ({{ type.company_set.count }})</a><br/>
                {% endfor %}
            </span>
        </div>

        <div class="row-fluid" style="margin-bottom: 20px;">
            <div class="span12">
                <img id="logo" src="/static/img/logomee.png" alt="MEE"/>
            </div>
        </div>

    </div>

    <div id="map_canvas">

    </div>
</div>
</body>
</html>
